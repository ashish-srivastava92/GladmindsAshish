{% extends "base_template.html" %}

{% block style %}
<link href="/static/css/portal.css" rel="stylesheet">
{% endblock %}

{% block body %}
<div class="well">
	<h3 class="text-center">Feedback Status</h3>
	<div class="container">
	<div class="col-md-9">
	<button class="btn btn-primary pull-left" data-toggle="modal" data-target="#myModal">
  	Add Ticket
	</button>
	</div>
		<div class="col-md-3">
			<div class="row">
            	<div class="col-md-4 form-group">
                <label class="control-label">Status</label>
                </div>
                <div class="col-md-8 form-group">
                	<select class="form-control" name="status" id="status" required>
                    	<option value="">Select Status</option>
                      	{% for status in status %}
                     		 <option value="{{status}}">{{status}}</option>
                      	{% endfor %}
                    </select>
                 </div>
            </div>
		</div>
	
		{% if not feedbacks %}
		<h4 class='text-center'>
		   {% if group == 'dealers' %}
			Hi {{request.user.username}} You dont have any feedback yet.
			{% endif %}
		</h4>
		{% elif feedbacks.length != 0 %}
		<table id="gladmindDesk" class="table table-striped table-bordered table-responsive	" >
        <thead>
				<tr>
				    <th>Ticket</th>
					<th>Reporter</th>
					<th>Message</th>
					<th>Status</th>
					<th>Created</th>
				</tr>
			</thead>
        <tbody>
				{% for feedback in feedbacks %}
				<tr> 
				    <td>
				       <a href="/aftersell/feedbackdetails/{{feedback.id}}/">
							GM-{{feedback.id|default_if_none:""}}
						</a>  
					</td>
					<td>{{feedback.reporter_name|default_if_none:""}}</td>
					<td>
					   <div>
					       {% if feedback.message|length > 20 %}
					         <span id="{{feedback.id}}" class="btn gladdesk-message ellips" 
					            data-content="{{feedback.message|default_if_none:""}}" rel="popover" 
					            data-placement="bottom" data-trigger="hover"  onmouseover="showMessage({{feedback.id}})">
					              {{feedback.message}}
					       {% else  %}
                                  {{feedback.message}}
                           {% endif %}
                            </span>
                       </div>
                   </td>
					<td>{{feedback.status|default_if_none:""}}</td>
					<td>{{feedback.created_date|default_if_none:""}}</td>
			</tr>
				{% endfor %}
			</tbody>
		</table>
		{% endif %}
	</div>
</div>


<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">Submit a Service Desk Ticket</h4>
      </div>
      <div class="modal-body">
		<form class="help-desk-form" role="search">
                <div class="row">
                  <div class="col-md-4 form-group">
                    <label class="control-label">Reporter*:</label>
                  </div>
                  <div class="col-md-8 form-group">
                    <select class="form-control" name="advisorMobile" id="advisorMobile" required>
                      <option value="">Select mobile number</option>
                      {% for phone in data %}
                      <option value="{{phone}}">{{phone.name}} ({{phone.phone_number}})</option>
                      {% endfor %}
                    </select>
                  </div>
                </div>
                   <div class="row">
                  <div class="col-md-4 form-group">
                    <label class="control-label">Subject*:</label>
                  </div>
                  <div class="col-md-8 form-group">
                    <input type="text" class="form-control" name="subject" id="subject" required>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-4 form-group">
                    <label class="control-label">Type*:</label>
                  </div>
                  <div class="col-md-8 form-group">
                    <select class="form-control" name="type" id="type" required>
                      <option value="">Select Type</option>
                      {% for type in types %}
                      <option value="{{type}}">{{type}}</option>
                      {% endfor %}
                    </select>
                  </div>
                </div>
				<div class="row">
                  <div class="col-md-4 form-group">
                    <label class="control-label">Priority*:</label>
                  </div>
                  <div class="col-md-8 form-group">
                    <select class="form-control" name="priority" id="priority" required>
                      <option value="">Select Priority</option>
                      {% for priority in priorities %}
                      <option value="{{priority}}">{{priority}}</option>
                      {% endfor %}
                    </select>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-4 form-group">
                    <label class="control-label">Message*:</label>
                  </div>
                  <div class="col-md-8 form-group">
                    <textarea class="form-control" name="message" id="message" required></textarea>
                  </div>
                </div> 
                <div class="row">
                  <div class="col-md-12 form-group">
                    <button type="submit" value="Submit" class="btn btn-primary pull-right">
                    Submit
                    </button>
                  </div>
                </div>               
                
         </form>
      </div>
    </div>
  </div>
</div>
{% include "portal/modal.html" %}
{% include "portal/waiting_modal.html" %}
{% endblock %}
 
{% block dependency%}

{% if active_menu == 'recover' %}
  <script>
  var jobCardFileData = null;
  </script>
{% endif %}

<script src="/static/js/table_data.js"></script>
<script src="/static/js/table_data_bootstrap.js"></script>
<script src="/static/js/portal/utils.js"></script>
<script src="/static/js/portal/main.js"></script>


<script>
$(document).ready(function() {
    $('#gladmindDesk').dataTable();
    change_status();
} );

</script>
{% endblock dependency %}